# 帕金森輔助裝置用戶手冊

## 目錄
1. [快速開始](#快速開始)
2. [設備連接](#設備連接)
3. [基本操作](#基本操作)
4. [功能詳解](#功能詳解)
5. [故障排除](#故障排除)
6. [維護保養](#維護保養)

## 快速開始

### 第一次使用
1. **檢查設備**: 確認Arduino設備和所有傳感器正常連接
2. **上電啟動**: 通過USB連接電腦，設備自動啟動
3. **狀態確認**: LED燈亮起表示系統正常
4. **按鈕測試**: 按下按鈕開始首次校準

### 5分鐘快速體驗
1. 按下設備上的按鈕
2. 按照提示保持手部放鬆2秒進行校準
3. 正常活動手指，系統開始實時分析
4. 5秒後獲得帕金森等級評估結果
5. 根據建議進行個性化訓練

## 設備連接

### 硬體連接圖
```
Arduino Nano 33 BLE Sense Rev2
├── A0 → 小指電位器
├── A1 → 無名指電位器  
├── A2 → 中指電位器
├── A3 → 食指電位器
├── A4 → 拇指電位器
├── A5 → EMG傳感器 (可選)
├── D2 → 電位器檢測引腳
├── D3 → EMG檢測引腳
├── D4 → 用戶按鈕
├── D9 → 舵機控制
└── LED_BUILTIN → 狀態指示燈
```

### 連接檢查清單
- [ ] Arduino電源正常 (USB或外部電源)
- [ ] 電位器正確連接到A0-A4
- [ ] EMG傳感器連接到A5 (如有)
- [ ] 舵機連接到D9
- [ ] 按鈕連接到D4
- [ ] 檢測電路連接到D2, D3

## 基本操作

### 按鈕操作
| 操作 | 功能 | 狀態指示 |
|------|------|----------|
| 短按 | 開始/停止實時分析 | LED閃爍→常亮/常滅 |
| 長按(2秒) | 緊急停止所有操作 | LED快速閃爍 |

### 串口命令
通過串口監視器 (9600波特率) 發送命令:

```
START          - 開始數據收集 (10秒)
TRAIN          - 開始訓練模式
CALIBRATE      - 重新校準基線
STATUS         - 查看系統狀態
SERVO,90       - 設定舵機角度 (0-180度)
STOP           - 停止當前操作
```

### 狀態指示
| LED狀態 | 系統狀態 | 說明 |
|---------|----------|------|
| 常滅 | 空閒 | 等待命令或按鈕操作 |
| 常亮 | 實時分析中 | 正在收集和分析數據 |
| 慢閃爍 | 校準中 | 正在進行基線校準 |
| 快閃爍 | 訓練中 | 執行阻力訓練程序 |
| 極快閃爍 | 錯誤 | 系統錯誤，需要重啟 |

## 功能詳解

### 1. 自動校準功能

#### 使用方法
1. 確保手部完全放鬆
2. 按下按鈕或發送`CALIBRATE`命令
3. 保持靜止2秒直到校準完成
4. 系統顯示基線校準值

#### 校準原理
- 測量靜息狀態下的傳感器基線值
- 後續測量都會減去基線值獲得相對變化
- 消除個體差異和環境影響

#### 注意事項
- 校準期間不要移動手指
- 環境溫度變化大時建議重新校準
- EMG電極接觸不良會影響校準效果

### 2. 實時帕金森分析

#### 分析流程
```
數據收集 (持續) → 滑動窗口緩衝 → AI模型推理 (每5秒) → 結果輸出
```

#### 輸出信息
```
=== AI分析結果 ===
帕金森等級: 3 (中度症狀)
置信度: 87.5%
訓練建議: 重點改善精細動作控制，舵機阻力設定90度
建議阻力設定: 90度
==================
```

#### 分析指標
- **手指靈活性**: 基於彎曲角度變化範圍
- **動作協調性**: 多手指協同運動分析
- **震顫程度**: 高頻抖動成分檢測
- **肌肉狀態**: EMG信號強度和穩定性
- **運動平滑度**: IMU加速度變化分析

### 3. 個性化訓練

#### 訓練等級對應
| 帕金森等級 | 訓練強度 | 舵機阻力 | 訓練時長 | 頻率 |
|------------|----------|----------|----------|------|
| 1級 (輕度) | 低強度 | 30度 | 15-20分鐘 | 每日2次 |
| 2級 (輕中度) | 低中強度 | 60度 | 20-25分鐘 | 每日2-3次 |
| 3級 (中度) | 中強度 | 90度 | 25-30分鐘 | 每日3次 |
| 4級 (中重度) | 中高強度 | 120度 | 20-30分鐘 | 每日2-3次 |
| 5級 (重度) | 適應性 | 150度 | 15-25分鐘 | 每日多次短時間 |

#### 訓練程序
1. **準備階段**: 舵機移動到起始位置 (90度)
2. **漸進訓練**: 阻力從0度逐漸增加到目標阻力
3. **保持訓練**: 在目標阻力下維持1秒
4. **放鬆階段**: 返回中位，休息2秒
5. **循環重複**: 完成5個完整週期

#### 安全保護
- 最大阻力限制 (不超過150度)
- 緊急停止功能 (長按按鈕)
- 過載保護 (檢測異常阻力)

### 4. 數據收集模式

#### 收集參數
- **採樣頻率**: 10Hz (每100ms一次)
- **收集時長**: 10秒 (共100個數據點)
- **數據格式**: CSV格式，包含時間戳

#### 數據內容
```
DATA,finger1,finger2,finger3,finger4,finger5,emg,imu_x,imu_y,imu_z
```

#### 使用場景
- 醫療評估記錄
- 模型訓練數據收集
- 康復進度跟踪
- 研究數據採集

## 故障排除

### 常見問題

#### 1. 設備無法啟動
**症狀**: LED不亮，串口無輸出
**解決方案**:
- 檢查USB連接
- 確認電源供應
- 重新上傳Arduino代碼
- 檢查硬體連接

#### 2. IMU初始化失敗
**症狀**: 串口顯示"ERROR: IMU初始化失敗!"
**解決方案**:
- 重啟Arduino設備
- 檢查IMU庫版本
- 確認Arduino型號 (必須是Nano 33 BLE Sense Rev2)

#### 3. AI模型初始化失敗
**症狀**: 串口顯示"ERROR: AI模型初始化失敗!"
**解決方案**:
- 檢查model_data.h文件是否正確複製
- 確認模型文件大小不超過限制
- 重新生成和部署模型

#### 4. 傳感器讀數異常
**症狀**: 數據值明顯不合理或不變化
**解決方案**:
- 檢查電位器連接和焊接
- 確認EMG電極接觸良好
- 重新校準基線值
- 檢查引腳配置

#### 5. 舵機不工作
**症狀**: 舵機無反應或異常震動
**解決方案**:
- 檢查舵機電源和信號線
- 確認舵機型號兼容性
- 測試舵機角度範圍
- 檢查PWM信號

### 診斷命令

#### 系統狀態檢查
```
STATUS
```
輸出系統完整狀態信息，包括:
- 當前運行狀態
- 校準狀態
- 設備連接狀態
- AI模型狀態
- 緩衝區狀態

#### 傳感器測試
```
START
```
開始數據收集，觀察數據是否正常變化

#### 舵機測試
```
SERVO,90
SERVO,45  
SERVO,135
SERVO,90
```
測試舵機在不同角度的響應

### 錯誤代碼

| 錯誤代碼 | 說明 | 解決方案 |
|----------|------|----------|
| IMU_INIT_FAIL | IMU初始化失敗 | 重啟設備，檢查硬體 |
| MODEL_LOAD_FAIL | AI模型加載失敗 | 重新部署模型文件 |
| CALIBRATION_FAIL | 校準失敗 | 檢查傳感器連接 |
| SERVO_ERROR | 舵機控制錯誤 | 檢查舵機連接和電源 |
| MEMORY_FULL | 內存不足 | 重啟設備，優化代碼 |

## 維護保養

### 日常維護
- **清潔**: 定期清潔設備表面和電極
- **檢查**: 檢查連接線是否鬆動
- **校準**: 環境變化時重新校準
- **更新**: 定期更新軟體和模型

### 定期保養
- **每週**: 全面功能測試
- **每月**: 清潔傳感器和電極
- **每季**: 檢查機械部件磨損
- **每年**: 專業檢查和校准

### 存儲建議
- 保存在乾燥環境中
- 避免極端溫度
- 定期充電或供電
- 防止機械衝擊

### 技術支持
如遇到無法解決的問題，請聯繫技術支持:
- 提供詳細的錯誤描述
- 包含系統狀態輸出
- 說明使用環境和條件
- 提供錯誤復現步驟

## 安全注意事項

### 使用安全
- 不要在舵機阻力下強行移動
- 感到不適時立即停止訓練
- 避免長時間連續使用
- 遵循醫療專業人員建議

### 電氣安全
- 使用合格的電源適配器
- 避免在潮濕環境中使用
- 定期檢查線路絕緣
- 發現異常立即斷電

### 數據安全
- 定期備份重要數據
- 保護個人健康信息
- 謹慎分享評估結果
- 遵守數據隱私法規